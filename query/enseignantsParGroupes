xquery version "3.0";

for $groupe in doc("Etudiants.xml")//groupe
    return 
        <enseignantAnnee>{$groupe/../../@value/string()}-{$groupe/../@value/string()}-{$groupe/@value/string()}
            {for $enseignant in doc("Enseignants.xml")//enseignant
            where (some $anneeEnseignee in $enseignant//groupesEnseigne/groupe/@annee satisfies $anneeEnseignee = $groupe/../../@value/string()) and (some $anneeEnseignee in $enseignant//groupesEnseigne/groupe/@cursus satisfies $anneeEnseignee = $groupe/../@value/string()) and (some $anneeEnseignee in $enseignant//groupesEnseigne/groupe/@groupe satisfies $anneeEnseignee = $groupe/@value/string())
            return $enseignant/nom}
        </enseignantAnnee>